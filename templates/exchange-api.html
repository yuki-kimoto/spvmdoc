    <div class="container">
<h2 id="exchange-api-summary">SPVM exchange API specification</a></h2>
      <p>
        <b> SPVM Exchange API specification </b> is described in this document. SPVM is in beta testing for the release of 1.0. The SPVM Exchange API specification is subject to change without warning.
      </p>
      <p>
        Last updated: 2020-05-15
      </p>
      
<h2 id="exchange-api-toc">Table of Contents</h2>
      <ul class="toc">
        <li><a href="#exchange-api-summary">What is the SPVM Exchange API</a></li>
        <li><a href="#exchange-api-perl-data-to-spvm-data">Convert perl data structures into SPVM data structures</a></li>
        <li><a href="#exchange-api-call-spvm-sub">Calls to spvm subroutines</a></li>
        <li><a href="#exchange-api-spvm-data-to-perl-data">Converting sPVM data structures into Perl data structures</a></li>
        <li><a href="#exchange-api-utility"> utility</a></li>
        <li><a href="#exchange-api-perl-scalar-to-spvm-numeric">Rules for converting Perl scalar values to SPVM numeric types</a></li>
        <li><a href="#exchange-api-rule-spvm-numeric-to-perl-scalar">Rules for converting spvm numeric types to Perl scalar values</a></li>
      </ul>
      
What is the <h2 id="exchange-api-summary">SPVM exchange API?</h2>
      <p>
        The SPVM Exchange API is an API for converting Perl and SPVM data structures and calling SPVM subroutines from Perl.
      </p>
      <ul class="list">
        <li> convert edits such as Perl numbers, strings and arrays into SPVM data structures</li>
        <li> convert spvm data structures into Perl numbers, strings, arrays, and other data structures</li>
        <li> call the SPVM subroutine</li>
      </ul>
      <p>
        Modules created in SPVM can be executed as Perl modules after compilation.
      </p>

<h2 id="exchange-api-perl-data-to-spvm-data">Convert perl data structures to SPVM data structures</h2>
      <ul class="toc">
        <li><a href="#exchange-api-perl-to-SPVM-Byte">Perl scalar values are converted to SPVM::Byte - SPVM::Byte-</a></li>
        <li><a href="#exchange-api-perl-perl-to-SPVM-Short">Convert Perl scalar values to SPVM::Short- SPVM::Short-</a></li>
        <li><a href="#exchange-api-perl-to-SPVM-Int">Perl scalar value is converted to SPVM::Int type - SPVM::Int-&gt;new</a></li>
        <li><a href="#exchange-api-perl-to-SPVM-Long">Perl scalar values are converted to SPVM::Long - SPVM::Long-&gt;new</a></li>
        <li><a href="#exchange-api-api-perl-to-SPVM-Float">Perl scalar values are converted to SPVM:Float- SPVM::Float-</a></li>
        <li><a href="#exchange-api-perl-to-SPVM-Double">Convert Perl scalar values to SPVM::Double type - SPVM::Double-&gt;new</a></li>
        <li><a href="#exchange-api-perl-array-ref-to-spvm-byte-array">Convert Perl array reference to SPVM byte[] type - SPVM::new_byte_array</a></li>
        <li><a href="#exchange-api-perl-array-ref-to-spvm-short-array">Convert perl array reference to Short[] type Of SPVM - SPVM::new_short_array</a></li>
        <li><a href="#exchange-api-perl-array-ref-to-spvm-int-array">Convert Perl array reference to SPVM int[] type - SPVM::new_int_array</a></li>
        <li><a href="#exchange-api-perl-array-ref-to-spvm-long-array">Convert Perl array reference to Long[] type of SPVM - SPVM::new_long_array</a></li>
        <li><a href="#exchange-api-perl-array-ref-to-spvm-float=array">Convert Perl array reference to SPVM float[] type - SPVM::new_float_array</a></li>
        <li><a href="#exchange-api-perl-array-ref-to-spvm-double-array">Convert perl array reference to spvm double[] type - SPVM::new_double_array</a></li>
        <li><a href="#exchange-api-perl-array-ref-to-spvm-object-array">Convert perl array reference to array type of SPVM object - SPVM::new_object_array</a></li>
        <li><a href="#exchange-api-perl-array-ref-to-spvm-value-array">Convert perl array reference to array type of SPVM value - SPVM::new_mulnum_array</a></li>
        <li><a href="#exchange-api-perl-binary-to-spvm-byte-array">Convert perl binary columns to SPVM byte[] - SPVM::new_byte_array_from_bin</a></li>
        <li><a href="#exchange-api-perl-binary-to-spvm-string">Convert perl binary columns to SPVM string - SPVM::new_string_from_bin</a></li>
        <li><a href="#exchange-api-perl-binary-to-spvm-short-array">Convert perl binary columns to short[] type Of SPVM - SPVM::new_short_array_from_bin</a></li>
        <li><a href="#exchange-api-perl-binary-to-spvm-int-array">Convert perl binary columns to SPVM int[] - SPVM::new_int_array_from_bin</a></li>
        <li><a href="#exchange-api-perl-binary-to-spvm-long-array">Convert perl binary columns to Long[] type - SPVM::new_long_array_from_bin</a></li>
        <li><a href="#exchange-api-perl-binary-to-spvm-float-array">Convert perl binary columns to SPVM float[] type - SPVM::new_byte_array_from_string</a></li>
        <li><a href="#exchange-api-perl-binary-to-spvm-double-array">Convert perl binary columns to spvm double[] - SPVM::new_double_array_from_bin</a></li>
        <li><a href="#exchange-api-perl-binary-to-spvm-value-array">Convert perl binary columns to spvm value array types - SPVM::new_mulnum_array_from_bin</a></li>
        <li><a href="#exchange-api-perl-string-to-spvm-byte-array">Convert perl strings to spvm byte[] type - SPVM::new_byte_array_from_string</a></li>
        <li><a href="#exchange-api-perl-string-to-spvm-string">Convert perl strings to SPVM string - SPVM::new_string</a></li>
      </ul>

<h3 id="exchange-api-perl-scalar-to-SPVM-Byte">Convert perl scalar values to SPVM:-Byte type of SPVM - SPVM::Byte-&gt;new</h3>
      <p>
        To convert perl scalar values to SPVM::Byte of SPVM, use the SPVM::Byte-&gt;new method.
      </p>
<pre>
my $spvm_byte = SPVM::Byte->new(98);
</pre>
      <p>
        Perl scalar values are converted to SPVMbyte types by the <a href="#exchange-api-rule-perl-scalar-to-spvm-numeric">Perl scalar value to spvm numeric type</a>, and the value is passed to the new method of SPVM::Byte, and an object of type SPVM:Byte is returned.
      </p>

<h3 id="exchange-api-perl-scalar-to-SPVM-Short">Convert Perl scalar values to SPVM::Short type of SPVM - SPVM::Short-&gt;new</h3>
      <p>
        To convert Perl scalar values to SPVM::Short in SPVM, use the SPVM::Short-&gt;new method.
      </p>
<pre>
my $spvm_short = SPVM::Short->new(9800);
</pre>
      <p>
        Perl scalar values are converted to spvm short types by the <a href="#exchange-api-rule-perl-scalar-to-spvm-numeric">Perl scalar value to spvm numeric type</a>, and the value is passed to the new method of SPVM:Short, and an object of type SPVM:Short is returned.
      </p>

<h3 id="exchange-api-perl-scalar-to-SPVM-Int">Convert Perl scalar values to SPVM::Int type of SPVM - SPVM::Int-&gt;new</h3>
      <p>
        To convert Perl scalar values to SPVM::Int of SPVM, use the SPVM::Int-&gt;new method.
      </p>
<pre>
my $spvm_int = SPVM::Int->new(100000);
</pre>
      <p>
        Perl scalar values are converted to spvm int types by the <a href="#exchange-api-rule-perl-scalar-to-spvm-numeric">Perl scalar values are converted to spvm numeric types</a>, and the value is passed to the new method of SPVM:Int, and the SPVM:Int object is returned.
      </p>

<h3 id="exchange-api-perl-scalar-to-SPVM-Long">Convert Perl scalar values to SPVM::Long type - SPVM::Long-&gt;new</h3>
      <p>
        When you convert perl scalar values to SPVM::Long in SPVM, you use the SPVM::Long-&gt;new method.
      </p>
<pre>
my $spvm_long = SPVM::Long->new(98);
</pre>
      <p>
        Perl scalar values are converted to long types of SPVM by the <a href="#exchange-api-rule-perl-scalar-to-spvm-numeric">The rule of converting Perl scalar values to SPVM numeric types</a> converts them to long types of SPVM, and the spvm:Long objects are returned.
      </p>

<h3 id="exchange-api-perl-scalar-to-SPVM-Float">Convert Perl scalar values to SPVM:Float type of SPVM - SPVM:Float-&gt;new</h3>
      <p>
        To convert Perl scalar values to SPVM::Float in SPVM, use the SPVM::Float-&gt;new method.
      </p>
<pre>
my $spvm_float = SPVM::Float->new(2.5);
</pre>
      <p>
        Perl scalar values are converted to spvm float types by the <a href="#exchange-#exchange-rule-perl-scalar-to-spvm-numeric">Perl scalar values are converted to spvm numeric types</a>, and that value is passed to the new method of SPVM:Float, and objects of SPVM:Float are returned.
      </p>

<h3 id="exchange-api-perl-scalar-to-SPVM-Double">Convert perl scalar values to SPVM::Double type - SPVM::Double-&gt;new</h3>
      <p>
        To convert Perl scalar values to SPVM::Double, use the SPVM::Double-&gt;new method.
      </p>
<pre>
my $spvm_double = SPVM::Double->new(2.5);
</pre>
      <p>
        Perl scalar values are converted to spvm double types by the <a href="#exchange-api-rule-perl-scalar-to-spvm-numeric">Perl scalar values are converted to spvm numeric types</a>, and that value is passed to the new method of SPVM :D, and objects of SPVM :Double are returned.
      </p>

<h3 id="exchange-api-perl-array-ref-to-spvm-byte-array">Convert perl array reference to spvm byte[] type - SPVM::new_byte_array</h3>
      <p>
        To convert perl array references to spvm byte[] types, use the SPVM::new_byte_array function.
      </p>
<pre>
my $spvm_nums = SPVM::new_byte_array([1, 2, 3]);
</pre>
      <p>
        Takes an array reference to the first argument.
      </p>
      <p>
        The value of each element in the array reference is converted from the Perl scalar value to the SPVM byte type by the rules for converting the scalar values of <a href="#exchange-#exchange-rule-perl-scalar-to-spvm-numeric">Perl scalar values to numeric types of SPVM</a>.
      </p>
      <p>
        The return value is the SPVM::Data::Array object that represents the "byte[] type" of SPVM.
      </p>
      <p>
        If the first argument is an undefined value, an undefined value is returned.
      </p>

<h3 id="exchange-api-perl-array-ref-to-spvm-short-array">Convert perl array reference to Short[] type of SPVM</h3>
      <p>
        To convert perl array references to spvm short[] types, use the SPVM::new_short_array function.
      </p>
<pre>
my $spvm_nums = SPVM::new_short_array([1, 2, 3]);
</pre>
      <p>
        Takes an array reference to the first argument.
      </p>
      <p>
        The value of each element in the array reference is converted from the Perl scalar value to the Short type of SPVM by the <a href="#exchange-api-rule-perl-scalar-to-spvm-numeric">Perl scalar value is converted to a numeric type of SPVM</a>.
      </p>
      <p>
        The return value is the SPVM::Data::Array object that represents the "short[]" type of SPVM.
      </p>
      <p>
        If the first argument is an undefined value, an undefined value is returned.
      </p>

<h3 id="exchange-api-perl-array-ref-to-spvm-int-array">Convert perl array reference to SPVM int[] type</h3>
      <p>
        To convert perl array references to spvm int[] types, use the SPVM::new_int_array function.
      </p>
<pre>
my $spvm_nums = SPVM::new_int_array([1, 2, 3]);
</pre>
      <p>
        Takes an array reference to the first argument.
      </p>
      <p>
        The value of each element in the array reference is converted from the Perl scalar value to the spvm int type by the rule to convert the <a href="#exchange-api-rule-perl-scalar-to-spvm-numeric">Perl scalar values to spvm numeric types</a>.
      </p>
      <p>
        The return value is the SPVM::Data::Array object that represents the "int[] type" of SPVM.
      </p>
      <p>
        If the first argument is an undefined value, an undefined value is returned.
      </p>

<h3 id="exchange-api-perl-array-ref-to-spvm-long-array">Convert perl array reference to Long[] type of SPVM</h3>
      <p>
        To convert perl array references to long[] types of SPVM, use the SPVM::new_long_array function.
      </p>
<pre>
my $spvm_nums = SPVM::new_long_array ([1, 2, 3]);
</pre>
      <p>
        Takes an array reference to the first argument.
      </p>
      <p>
        The value of each element in the array reference is converted from perl scalar values to long types of SPVM by the following conversions from perlapi and C99 type conversions:
      </p>
<pre>
(int64_t) SvIV (perl_value)
</pre>
      <p>
        The return value is the SPVM::Data::Array object that represents the "long[]" type of SPVM.
      </p>
      <p>
        If the first argument is an undefined value, an undefined value is returned.
      </p>

<h3 id="exchange-api-perl-array-ref-to-spvm-float-array">Convert perl array reference to SPVM float[] type</h3>
      <p>
        To convert perl array references to spvm float[] types, use the SPVM::new_float_array function.
      </p>
<pre>
my $spvm_nums = SPVM::new_float_array([1, 2, 3]);
</pre>
      <p>
        Takes an array reference to the first argument.
      </p>
      <p>
        The value of each element in the array reference is converted from perl scalar values to float types of SPVM by the following conversions from perlapi and C99 type conversions:
      </p>
<pre>
(float) SvNV(perl_value)
</pre>
      <p>
      <p>
        The return value is the SPVM::Data::Array object that represents the "float[] type" of SPVM.
      </p>
      <p>
        If the first argument is an undefined value, an undefined value is returned.
      </p>

<h3 id="exchange-api-perl-array-ref-to-spvm-double-array">Convert perl array reference to SPVM double[]</h3>
      <p>
        To convert perl array references to spvm double[] types, use the SPVM::new_double_array function.
      </p>
<pre>
my $spvm_nums = SPVM::new_double_array([1, 2, 3]);
</pre>
      <p>
        Takes an array reference to the first argument.
      </p>
      <p>
        The value of each element in the array reference is converted from perl scalar values to double types of SPVM by the following conversions from perlapi and C99 type conversions:
      </p>
<pre>
(double) SvNV(perl_value)
</pre>
      <p>
      <p>
        The return value is the SPVM::Data::Array object that represents the "double[] type" of SPVM.
      </p>
      <p>
        If the first argument is an undefined value, an undefined value is returned.
      </p>

<h3 id="exchange-api-perl-array-ref-to-spvm-object-array">Convert perl array reference to array type of SPVM object - SPVM::new_object_array</h3>
      <p>
        To convert perl array references to array types of SPVM objects, use the SPVM::new_object_array function.
      </p>
<pre>
my $byte_array = SPVM::new_object_array("SPVM::Byte[]",[SPVM::Byte->new(1), SPVM::Byte>new(2), SPVM::Byte->new(3)]);
</pre>
      <p>
        The first argument specifies the type name. It must be an array type that is an element of the base type that exists. Otherwise, an exception is raised.
      </p>
      <p>
        The second argument is perl array reference. The element must be an object that inherits "SPVM::Data" representing the object type of the SPVM, or an undefined value. Otherwise, an exception is raised.
      </p>
      <p>
        The return value is an "SPVM::Data::Array" object that represents the array type of the SPVM.
      </p>
      <p>
        You can also generate multidimensional arrays.
      </p>
<pre>
my $object1 = SPVM::new_int_array ([1, 2, 3]);
my $object2 = SPVM::new_int_array ([4, 5, 6]);
my $oarray = SPVM::new_object_array ("int[][]",[$object1, $object2]);
</pre>

<h3 id="exchange-api-perl-array-ref-to-spvm-value-array">Convert perl array reference to array type of SPVM value - SPVM::new_mulnum_array</h3>
      <p>
        To convert perl array references to array types of SPVM values, use the SPVM::new_mulnum_array function.
      </p>
<pre>
    my $perl_values = [
      {x => 0, y => 1, z => 2},
      {x => 3, y => 4, z => 5},
      {x => 6, y => 7, z => 8},
    ];
    my $spvm_value_array = SPVM::new_mulnum_array("TestCase::Point_3i[],$values);
</pre>
      <p>
        The first argument specifies the array type of the value of the SPVM.
      </p>
      <p>
        The second argument is an array reference with a hash reference on the element. The key of the hash reference must contain the values of all fields of multinumeric type. Otherwise, an exception is raised.
      </p>
      <p>
        The return value is an "SPVM::Data::Array" object that represents the array type of the Value of SPVM.
      </p>
      <p>
        The values in the hash reference are converted by the <a href="#exchange-api-rule-perl-scalar-to-spvm-numeric">Perl scalar values by </a> rules that convert scalar values to SPVM numeric types.
      </p>
      <p>
        There are some samples.
      </p>
<pre>
# new_mulnum_array - byte
{
  my $values = [
    {x => 0, y => 1, z => 2},
    {x => 3, y => 4, z => 5},
    {x => 6, y => 7, z => 8},
  ];
  my $spvm_value_array = SPVM::new_mulnum_array("TestCase::Point_3b[]", $values);
}

# new_mulnum_array - short
{
  my $values = [
    {x => 0, y => 1, z => 2},
    {x => 3, y => 4, z => 5},
    {x => 6, y => 7, z => 8},
  ];
  my $spvm_value_array = SPVM::new_mulnum_array("TestCase::Point_3s[]",$values);
}

# new_mulnum_array - int
{
  my $values = [
    {x => 0, y => 1, z => 2},
    {x => 3, y => 4, z => 5},
    {x => 6, y => 7, z => 8},
  ];
  my $spvm_value_array = SPVM::new_mulnum_array("TestCase::Point_3i[],$values);
}

# new_mulnum_array - long
{
  my $values = [
    {x => 0, y => 1, z => 2},
    {x => 3, y => 4, z => 5},
    {x => 6, y => 7, z => 8},
  ];
  my $spvm_value_array = SPVM::new_mulnum_array("TestCase::Point_3l[]", $values);
}

# new_mulnum_array - float
{
  my $values = [
    {x => 0, y => 1, z => 2},
    {x => 3, y => 4, z => 5},
    {x => 6, y => 7, z => 8},
  ];
  my $spvm_value_array = SPVM::new_mulnum_array("TestCase::Point_3f[]",$values);
}

# new_mulnum_array - double
{
  my $values = [
    {x => 0, y => 1, z => 2},
    {x => 3, y => 4, z => 5},
    {x => 6, y => 7, z => 8},
  ];
  my $spvm_value_array = SPVM::new_mulnum_array("TestCase::Point_3d[],"$values);
  ok (TestCase:: ExchangeAPI-spvm_new_mulnum_array_double ($spvm_value_array));
  my $out_values = $spvm_value_array->to_elems;
  is_deeply ($out_values, $values);
}

</pre>

<h3 id="exchange-api-perl-binary-to-spvm-byte-array">Convert perl binary columns to spvm byte[] type - SPVM:new_byte_array_from_bin</h3>
      <p>
        To convert perl binary columns to the byte[] type of SPVM, use the SPVM::new_byte_array_from_bin function.
      </p>
<pre>
my $perl_binary = pack('c3', 97, 98, 99);
my $spvm_byte_array = SPVM::new_byte_array_from_bin ($perl_binary);
</pre>
      <p>
        The first argument takes perl binary columns.
      </p>
      <p>
        Binary columns are interpreted as 8-bit signed integers arranged in byte order in the execution environment. The length is the length when interpreted as an 8-bit signed integer.
      </p>
      <p>
        The return value is the SPVM::Data::Array object that represents the "byte[] type" of SPVM.
      </p>
      <p>
        If the first argument is an undefined value, an undefined value is returned.
      </p>
      <p>
        The sample above also has the same meaning as: Binary columns can be a sequence of 8-bit signed integers, using a pack or a string that is not perl decode.
      </p>
<pre>
my $binary ="abc";
my $spvm_byte_array = SPVM::new_byte_array_from_bin ($perl_binary);
</pre>

<h3 id="exchange-api-perl-binary-to-spvm-string">Convert perl binary columns to SPVM string - SPVM::new_string_from_bin</h3>

<p>
        To convert perl binary columns to SPVM string types, use the SPVM::new_string_from_bin function.
      </p>
<pre>
my $perl_binary = pack('c3', 97, 98, 99);
my $spvm_byte_array = SPVM::new_string_from_bin($perl_binary);
</pre>
      <p>
        The first argument takes perl binary columns.
      </p>
      <p>
        Binary columns are interpreted as 8-bit signed integers arranged in byte order in the execution environment. The length is the length when interpreted as an 8-bit signed integer.
      </p>
      <p>
        The return value is the SPVM::Data::Array object that represents the "byte[] type" of SPVM. The string type of SPVM is treated as a byte[] type at run time.
      </p>
      <p>
        If the first argument is an undefined value, an undefined value is returned.
      </p>
      <p>
        The sample above also has the same meaning as: Binary columns can be a sequence of 8-bit signed integers, using a pack or a string that is not perl decode.
      </p>
<pre>
my $binary ="abc";
my $spvm_byte_array = SPVM::new_byte_array_from_bin ($perl_binary);
</pre>

<p>
        This function is actually an alias for <a href="#exchange-api-perl-binary-to-spvm-byte-array">SPVM::new_byte_array_from_bin</a>.
      </p>
      
<h3 id="exchange-api-perl-binary-to-spvm-short-array">Convert perl binary columns to short[] type Of SPVM - SPVM:new_short_array_from_bin</h3>
      <p>
        To convert perl binary columns to the short[] type of SPVM, use the SPVM::new_short_array_from_bin function.
      </p>
<pre>
my $perl_binary = pack('s3', 97, 98, 99);
my $spvm_short_array = SPVM::new_short_array_from_bin ($perl_binary);
</pre>
      <p>
        The first argument takes perl binary columns.
      </p>
      <p>
        Binary columns are interpreted as a 16-bit signed integer sequence arranged in byte order in the execution environment. The length is the length when interpreted as a 16-bit signed integer.
      </p>
      <p>
        The return value is the SPVM::Data::Array object that represents the "short[]" type of SPVM.
      </p>
      <p>
        If the first argument is an undefined value, an undefined value is returned.
      </p>

<h3 id="exchange-api-perl-binary-to-spvm-int-array">Convert perl binary columns to spvm int[] - SPVM::new_int_array_from_bin</h3>
      <p>
        To convert perl binary columns to the SPVM int[] type, use the SPVM::new_int_array_from_bin function.
      </p>
<pre>
my $perl_binary = pack('l3', 97, 98, 99);
my $spvm_int_array = SPVM::new_int_array_from_bin ($perl_binary);
</pre>
      <p>
        The first argument takes perl binary columns.
      </p>
      <p>
        Binary columns are interpreted as a 32-bit signed integer sequence arranged in byte order in the execution environment. The length is the length when interpreted as a 32-bit signed integer.
      </p>
      <p>
        The return value is the SPVM::Data::Array object that represents the "int[] type" of SPVM.
      </p>
      <p>
        If the first argument is an undefined value, an undefined value is returned.
      </p>

<h3 id="exchange-api-perl-binary-to-spvm-long-array">Convert perl binary columns to long[] type Of SPVM - SPVM::new_long_array_from_bin</h3>
      <p>
        To convert perl binary columns to the Long[] type of SPVM, use the SPVM::new_long_array_from_bin function.
      </p>
<pre>
my $perl_binary = pack('q3', 97, 98, 99);
my $spvm_long_array = SPVM::new_long_array_from_bin ($perl_binary);
</pre>
      <p>
        The first argument takes perl binary columns.
      </p>
      <p>
        Binary columns are interpreted as a 64-bit signed integer sequence arranged in byte order in the execution environment. The length is the length when interpreted as a 64-bit signed integer.
      </p>
      <p>
        The return value is the SPVM::Data::Array object that represents the "long[]" type of SPVM.
      </p>
      <p>
        If the first argument is an undefined value, an undefined value is returned.
      </p>

<h3 id="exchange-api-perl-binary-to-spvm-float-array">Convert perl binary columns to float[] type of SPVM - SPVM::new_float_array_from_bin</h3>
      <p>
        To convert perl binary columns to the float [] type of SPVM, use the SPVM::new_float_array_from_bin function.
      </p>
<pre>
my $perl_binary = pack('f3', 0.5, 1.5, 2.5);
my $spvm_float_array = SPVM::new_float_array_from_bin ($perl_binary);
</pre>
      <p>
        The first argument takes perl binary columns.
      </p>
      <p>
        Binary columns are interpreted as 32-bit floating-point sequences arranged in byte order in the execution environment. The length is the length when interpreted as a 32-bit floating point.
      </p>
      <p>
        The return value is the SPVM::Data::Array object that represents the "float[] type" of SPVM.
      </p>
      <p>
        If the first argument is an undefined value, an undefined value is returned.
      </p>

<h3 id="exchange-api-perl-binary-to-spvm-double-array">Convert perl binary columns to spvm double[] - SPVM:new_double_array_from_bin</h3>
      <p>
        To convert perl binary columns to the double[] type of SPVM, use the SPVM::new_double_array_from_bin function.
      </p>
<pre>
my $perl_binary = pack('f3', 0.5, 1.5, 2.5);
my $spvm_double_array = SPVM::new_double_array_from_bin ($perl_binary);
</pre>
      <p>
        The first argument takes perl binary columns.
      </p>
      <p>
        Binary columns are interpreted as 32-bit floating-point sequences arranged in byte order in the execution environment. The length is the length when interpreted as a 32-bit floating point.
      </p>
      <p>
        The return value is the SPVM::Data::Array object that represents the "double[] type" of SPVM.
      </p>
      <p>
        If the first argument is an undefined value, an undefined value is returned.
      </p>

<h3 id="exchange-api-perl-binary-to-spvm-value-array">Convert perl binary columns to array types of SPVM values - SPVM::new_mulnum_array_from_bin</h3>
      <p>
        To convert perl-packed binaries to array types of SPVM values, use the SPVM::new_mulnum_array_from_bin function.
      </p>
<pre>
    my $binary = pack('l9', ($INT_MIN, 1, 2), (3, 4, 5), (6, 7, 8));
    my $spvm_value_array = SPVM::new_mulnum_array_from_bin("TestCase::Point_3i[],"$binary);
</pre>
      <p>
        The first argument specifies the Perl packed binaries. The length of the binary is multiplied by the number of multinumeric fields and the field width, which must be disdivided. Otherwise, an exception is raised.
      </p>
      <p>
        The second argument specifies the array type of the value of the SPVM.
      </p>
      <p>
        The return value is an "SPVM::Data::Array" object that represents the array type of the Value of SPVM. The length of the returned array is the length of the binary, multiplied by the number of multinumeric fields and the field width, divided.
      </p>
      <p>
        There are some samples.
      </p>
<pre>
# new_mulnum_array_from_bin - byte
{
  my $binary = pack('c9', (0, 1, 2), (3, 4, 5), (6, 7, 8));
  my $spvm_value_array = SPVM::new_mulnum_array_from_bin("TestCase::Point_3b[]", $binary);
}

# new_mulnum_array_from_bin - short
{
  my $binary = pack('s9', (0, 1, 2), (3, 4, 5), (6, 7, 8);;
  my $spvm_value_array = SPVM::new_mulnum_array_from_bin("TestCase::Point_3s[]",$binary);
}

# new_mulnum_array_from_bin - int
{
  my $binary = pack('l9', (0, 1, 2), (3, 4, 5), (6, 7, 8));
  my $spvm_value_array = SPVM::new_mulnum_array_from_bin("TestCase::Point_3i[],"$binary);
}

# new_mulnum_array_from_bin - long
{
  my $binary = pack ('q9', (0, 1, 2), (3, 4, 5), (6, 7, 8));
  my $spvm_value_array = SPVM::new_mulnum_array_from_bin("TestCase::Point_3l[]", $binary);
}

# new_mulnum_array_from_bin - float
{
  my $binary = pack('f9', (0, 1, 2), (3, 4, 5), (6, 7, 8));
  my $spvm_value_array = SPVM::new_mulnum_array_from_bin("TestCase::Point_3f[],"$binary);
}

# new_mulnum_array_from_bin - double
{
  my $binary = pack('d9', (0, 1, 2), (3, 4, 5), (6, 7, 8));
  my $spvm_value_array = SPVM::new_mulnum_array_from_bin("TestCase::Point_3d[],"$binary);
}
</pre>
      
<p>
        The first argument specifies the array type of the value of the SPVM.
      </p>
      <p>
        The second argument is an array reference with a hash reference on the element. The key of the hash reference must contain the values of all fields of multinumeric type. Otherwise, an exception is raised.
      </p>

<h2 id="exchange-api-spvm-data-to-perl-data">Convert ing SPVM data structures into Perl data structures</h2>
      <ul class="toc">
        <li><a href="#exchange-api-spvm-array-to-perl-array-ref">Convert spvm array to Perl array reference - to_elems</a></li>
        <li><a href="#exchange-api-spvm-array-to-perl-binary">Convert ing an array of SPVM to perl binary columns - to_bin</a></li>
        <li><a href="#exchange-api-spvm-string-to-perl-string">Convert spvm strings to Perl strings - to_string</a></li>
        <li><a href="#exchange-api-spvm-string-array-to-perl-string-string-array-ref">Convert ing an array of SPVM strings into perl string array reference - to_strings</a></li>
      </ul>
      
<h3 id="exchange-api-spvm-array-to-perl-array-ref">Convert sPVM array to Perl array reference - to_elems</h3>
      <p>
        To convert an array of SPVM to perl array reference, use the SPVM::Data::Array to_elems method.
      </p>
<pre>
my $perl_array_ref = $spvm_array->to_elems;
</pre>
      <p>
        If the elements of the SPVM array are numeric types, the <a href="#exchange-api-rule-spvm-numeric-to-perl-scalar">SPVM numeric types are converted by the</a> rules that convert numeric types of Perl to perl scalar values.
      </p>
      <p>
        If the element of the SPVM array is an object type, the corresponding SPVM::Data or its subclass is created.
      </p>
      <p>
        If the elements of the SPVM array are multinumeric types, a hash reference is created with the key and value of the field. The value is converted by a rule that converts the numeric type of <a href="#exchange-api-rule-spvm-numeric-to-perl-scalar">SPVM to perl scalar values</a>.
      </p>
      <p>
        If the elements of the SPVM array are undefined values, they are converted to undefined Perl values.
      </p>

<h3 id="exchange-api-spvm-array-to-perl-binary">Convert ing an array of SPVM to perl binary columns - to_bin</h3>
      <p>
        To convert an array of SPVM to perl binary columns, use the SPVM::Data::Array to_bin method.
      </p>
<pre>
my $perl_binary = $spvm_array-to_bin;
</pre>
      <p>
        If the array of SPVM is a numeric array type or a value array type, the binary representation in SPVM is copied directly into the scalar variable.
      </p>
      <p>
        If the Array of SPVM is of any other type, an exception is raised.
      </p>

<h3 id="exchange-api-spvm-string-to-perl-string">Convert sPVM strings to Perl strings - to_string</h3>
      <p>
        To convert an SPVM string to a Perl string, use the SPVM::Data::Array to_string method.
      </p>
<pre>
my $perl_array_ref = $spvm_array->to_string;
</pre>
      <p>
        If the SPVM type is of byte[] or string type, it is converted to a string decoded by Perl UTF-8.
      </p>
      <p>
        If the Data in SPVM is an undefined value, it is converted to an undefined value in Perl.
      </p>
      <p>
        If the Data in SPVM is of a type other than the above, an exception is raised.
      </p>

<h3 id="exchange-api-spvm-string-array-to-perl-string-string-string-array-ref">Convert an array of SPVM strings to an array reference of Perl strings - to_strings</h3>
      <p>
        To convert an array of SPVM strings to an array reference of Perl strings, use the SPVM::Data::Array to_strings method.
      </p>
<pre>
my $perl_array_ref = $spvm_array->to_strings;
</pre>
      <p>
        If the SPVM type is of byte[]], or string[], it is converted to a reference for an array of perl UTF-8 decoded strings.
      </p>
      <p>
        If an element of the SPVM array type is an undefined value, it is converted to an undefined value in Perl.
      </p>
      <p>
        If the Data in SPVM is of a type other than the above, an exception is raised.
      </p>

<h2 id="exchange-api-call-spvm-sub">Calling subroutines for SPVM</h2>
      
<ul class="toc">
        <li><a href="#exchange-api-call-spvm-sub-use-module">Loading SPVM module</a></li>
        <li><a href="#exchange-api-call-spvm-sub-sub-call">Subroutine call</a></li>
        <li><a href="#exchange-api-call-spvm-sub-method-call">Method call</a></li>
        <li><a href="#exchange-api-call-spvm-sub-convert-argument"> conversion in argument</a></li>
        <li><a href="#exchange-api-call-sub-convert-return-value"> conversion </a></li> in return value
      </ul>
      
<h3 id="exchange-api-call-spvm-sub-use-module">Loading SPVM modules</h3>
      <p>
        The SPVM module can be loaded from Perl as follows: The module name and search rules are the same as Perl, except that the extension is "spvm".
      </p>

<pre>
# script.pl

use SPVM 'Foo';
</pre>

      <p>
        モジュールの検索パス上に以下のFoo.spvmが配置されているとします。
      </p>

<pre>
# Foo.spvm
package Foo {
  sub sum : int ($x1 : int, $x2 : int) {
    
    return $x1 + $x2;
  }
}
</pre>

      <h3 id="exchange-api-call-spvm-sub-sub-call">サブルーチン呼び出し</h3>
      <p>
        サブルーチンを呼び出すためには、<a href="#exchange-api-call-spvm-sub-use-module">SPVMモジュールの読み込み</a>によって、SPVMモジュールが読み込まれている必要があります。
      </p>
      
<pre>
# script.pl

use SPVM 'Foo';
</pre>

      <p>
        モジュールの検索パス上に以下のFoo.spvmが配置されているとします。
      </p>

<pre>
# Foo.spvm
package Foo {
  sub sum : int ($x1 : int, $x2 : int) {
    
    return $x1 + $x2;
  }
}
</pre>

      <p>
        SPVMのサブルーチンは、Perlのサブルーチンでラッピングされ、Perlのクラスメソッド呼び出しを使って呼び出すことができます。
      </p>

<pre>
# script.pl

use SPVM 'Foo';

my $total = Foo->sum(1, 2);
</pre>
      <p>
        引数の個数がSPVMのサブルーチンの引数の個数と一致しない場合は、例外が発生します。
      </p>
      <p>
        引数に渡されるPerlの値は、<a href="#exchange-api-call-spvm-sub-convert-argument">引数における変換</a>によって、SPVMの値に変換されます。
      </p>
      <p>
        変換後の型が、SPVMのサブルーチンの引数の型に適合しない場合は、例外が発生します。
      </p>
      <p>
        戻り値は、戻り値における変換によって、変換されます。
      </p>
      <p>
        SPVMの例外は、Perlの例外に変換されます。
      </p>

      <h3 id="exchange-api-call-spvm-sub-method-call">メソッド呼び出し</h3>
      <p>
        メソッドを呼び出すためには、<a href="#exchange-api-call-spvm-sub-use-module">SPVMモジュールの読み込み</a>によって、SPVMモジュールが読み込まれている必要があります。
      </p>
      
<pre>
# script.pl

use SPVM 'Foo';
</pre>

      <p>
        モジュールの検索パス上に以下のFoo.spvmが配置されているとします。
      </p>

<pre>
# Foo.spvm
package Foo {
  sub new : Foo {
    return new Foo;
  }
  
  sub sum : int ($self : self, $x1 : int, $x2 : int) {
    return $x1 + $x2;
  }
}
</pre>

      <p>
        SPVMのメソッドは、Perlのサブルーチンでラッピングされ、Perlのメソッド呼び出しを使って呼び出すことができます。
      </p>

<pre>
# script.pl

use SPVM 'Foo';

my $foo = Foo->new;

my $total = $foo->sum(1, 2);
</pre>
      <p>
        引数の個数がSPVMのサブルーチンの引数の個数と一致しない場合は、例外が発生します。
      </p>
      <p>
        引数に渡されるPerlの値は、<a href="#exchange-api-call-spvm-sub-convert-argument">引数における変換</a>によって、SPVMの値に変換されます。
      </p>
      <p>
        変換後の型が、SPVMのサブルーチンの引数の型に適合しない場合は、例外が発生します。
      </p>
      <p>
        戻り値は、戻り値における変換によって、変換されます。
      </p>
      <p>
        SPVMの例外は、Perlの例外に変換されます。
      </p>

      <h3 id="exchange-api-call-spvm-sub-convert-argument">引数における変換</h3>

      <h4>数値型</h4>
      <p>
        SPVMのサブルーチンの定義の引数の型が数値型であった場合は、引数の値は<a href="#exchange-api-rule-perl-scalar-to-spvm-numeric">Perlのスカラ値をSPVMの数値型に変換する規則</a>によって、SPVMの数値に変換されます。
      </p>
<pre>
# SPVMのサブルーチン定義
package Foo {
  sub call_byte : void ($num : byte);
  sub call_short : void ($num : short);
  sub call_int : void ($num : int);
  sub call_long : void ($num : long);
  sub call_float : void ($num : float);
  sub call_double : void ($num : double);
}

# Perlから呼び出し
Foo->call_byte(23);
Foo->call_short(23);
Foo->call_int(23);
Foo->call_long(23);
Foo->call_float(2.3);
Foo->call_double(2.3);
</pre>

      <h4>複数数値型</h4>
      <p>
        SPVMのサブルーチンの定義の引数の型が複数数値型であった場合は、引数の値は、ハッシュのリファレンスで、キーには、複数数値型のすべてのフィールド名が含まれている必要があります。そうでない場合は、例外が発生します。ハッシュリファレンスの値は、<a href="#exchange-api-rule-perl-scalar-to-spvm-numeric">Perlのスカラ値をSPVMの数値型に変換する規則</a>によって、SPVMの値に変換されます。
      </p>
<pre>
# SPVMのサブルーチン定義
package Foo {
  sub call_complex_float : void ($z : SPVM::Complex_2f);
  sub call_complex_double : void ($z : SPVM::Complex_2d);
}

# Perlから呼び出し
Foo->call_complex_float({re => 2.3, im => 5.6});
Foo->call_complex_double({re => 2.3, im => 5.6});
</pre>
      
      <h4>数値のリファレンス型</h4>
      <p>
        SPVMのサブルーチンの定義の引数の型が数値のリファレンス型であった場合は、引数の値は、スカラのリファレンスでなければなりません。そうでない場合は、例外が発生します。
      </p>
<pre>
# SPVMのサブルーチン定義
package Foo {
  sub call_byte_ref : void ($num : byte&);
  sub call_short_ref : void ($num : short&);
  sub call_int_ref : void ($num : int&);
  sub call_long_ref : void ($num : long&);
  sub call_float_ref : void ($num : float&);
  sub call_double_ref : void ($num : double&);
}

# Perlから呼び出し
my $num_byte = 23;
Foo->call_byte_ref(\$num_byte);

my $num_short = 23;
Foo->call_short_ref(\$num_short);

my $num_int = 23;
Foo->call_int_ref(\$num_int);

my $num_long = 23;
Foo->call_long_ref(\$num_long);

my $num_float = 23;
Foo->call_float_ref(\$num_float);

my $num_double = 23;
Foo->call_double_ref(\$num_double);
</pre>

      <p>
        SPVMのサブルーチンの定義の引数の型が複数数値のリファレンス型であった場合は、引数の値は、ハッシュのリファレンスのリファレンスで、キーには、複数数値型のすべてのフィールド名が含まれている必要があります。そうでない場合は、例外が発生します。
      </p>
      <p>
        SPVMのサブルーチンの定義の引数の型が、数値の配列型であった場合は、Perlの配列のリファレンスは、対応するPerlのSPVM::Data::Arrayオブジェクトに変換されます。要素の値は、<a href="#exchange-api-rule-perl-scalar-to-spvm-numeric">Perlのスカラ値をSPVMの数値型に変換する規則</a>によって、SPVMの数値に変換されます。引数が文字列で、
      </p>
      <p>
        SPVMのサブルーチンの定義の引数の型が、byte[]型であった場合は、Perlのデコードされた文字列は、UTF-8にエンコードされ、byte[]を表現するPerlのSPVM::Data::Arrayオブジェクトに変換されます。
      </p>
      <p>
        SPVMのサブルーチンの定義の引数の型が、オブジェクト型で、引数に渡される値が未定義値であった場合は、SPVMの未定義値に変換されます。
      </p>
      <p>
        SPVMのサブルーチンの定義の引数の型が、文字列互換型で、引数に渡される値が、リファレンスではないスカラ値であった場合は、UTF-8にエンコードされ、SPVMのbyte[]型を表現するPerlのSPVM::Data::Arrayオブジェクトに変換されます。
      </p>
      <p>
        SPVMのサブルーチンの定義の引数の型が、文字列互換型の配列型で、引数に渡される値が、配列リファレンスかつ最初の要素がリファレンスではないスカラ値であった場合は、SPVMのbyte[][]を表現するPerlのSPVM::Data::Arrayオブジェクトに変換されます。要素は未定義値であった場合は、SPVMの未定義値に変換され、そうでない場合は、UTF-8にエンコードされ、SPVMのbyte[]型に変換されます。
      </p>
      <p>
        SPVMのサブルーチンの定義の引数の型が、byte[]型で、引数に渡される値が、配列リファレンスであった場合は、byte[]を表現するPerlのSPVM::Data::Arrayオブジェクトに変換されます。要素の値は<a href="#exchange-api-rule-perl-scalar-to-spvm-numeric">Perlのスカラ値をSPVMの数値型に変換する規則</a>によって変換されます。
      </p>
      <p>
        SPVMのサブルーチンの定義の引数の型が、short[]型で、引数に渡される値が、配列リファレンスであった場合は、short[]を表現するPerlのSPVM::Data::Arrayオブジェクトに変換されます。要素の値は<a href="#exchange-api-rule-perl-scalar-to-spvm-numeric">Perlのスカラ値をSPVMの数値型に変換する規則</a>によって変換されます。
      </p>
      <p>
        SPVMのサブルーチンの定義の引数の型が、int[]型で、引数に渡される値が、配列リファレンスであった場合は、int[]を表現するPerlのSPVM::Data::Arrayオブジェクトに変換されます。要素の値は<a href="#exchange-api-rule-perl-scalar-to-spvm-numeric">Perlのスカラ値をSPVMの数値型に変換する規則</a>によって変換されます。
      </p>
      <p>
        SPVMのサブルーチンの定義の引数の型が、long[]型で、引数に渡される値が、配列リファレンスであった場合は、long[]を表現するPerlのSPVM::Data::Arrayオブジェクトに変換されます。要素の値は<a href="#exchange-api-rule-perl-scalar-to-spvm-numeric">Perlのスカラ値をSPVMの数値型に変換する規則</a>によって変換されます。
      </p>
      <p>
        SPVMのサブルーチンの定義の引数の型が、float[]型で、引数に渡される値が、配列リファレンスであった場合は、float[]を表現するPerlのSPVM::Data::Arrayオブジェクトに変換されます。要素の値は<a href="#exchange-api-rule-perl-scalar-to-spvm-numeric">Perlのスカラ値をSPVMの数値型に変換する規則</a>によって変換されます。
      </p>
      <p>
        SPVMのサブルーチンの定義の引数の型が、double[]型で、引数に渡される値が、配列リファレンスであった場合は、double[]を表現するPerlのSPVM::Data::Arrayオブジェクトに変換されます。要素の値は<a href="#exchange-api-rule-perl-scalar-to-spvm-numeric">Perlのスカラ値をSPVMの数値型に変換する規則</a>によって変換されます。
      </p>
      <p>
        SPVMのサブルーチンの定義の引数の型が、object[]型で、引数に渡される値が、配列リファレンスであった場合は、object[]を表現するPerlのSPVM::Data::Arrayオブジェクトに変換されます。要素の値が未定義値であった場合は、SPVMの未定義に変換され、リファレンスでないスカラ値であった場合は、UTF-8にエンコードされ、SPVMのbyte[]型に変換され、PerlのSPVM::Dataオブジェクトであれば、変換はされません。それ以外の場合は、例外が発生します。
      </p>
      
      <h3 id="exchange-api-call-spvm-sub-convert-return-value">戻り値における変換</h3>
      <p>
        戻り値が、SPVMの数値型であった場合は、<a href="#exchange-api-rule-spvm-numeric-to-perl-scalar">SPVMの数値型をPerlのスカラ値に変換する規則</a>によって、Perlのスカラ値に変換されます。
      </p>
      <p>
        戻り値が、SPVMの複数数値型であった場合は、ハッシュのリファレンスに変換されます。キーは、SPVMの複数数値型のフィールド名で、値は<a href="#exchange-api-rule-spvm-numeric-to-perl-scalar">SPVMの数値型をPerlのスカラ値に変換する規則</a>によってPerlのスカラ値に変換された値になります。
      </p>
      <p>
        戻り値が、SPVMのオブジェクト型で未定義値であった場合は、Perlの未定義値に変換されます。
      </p>
      <p>
        戻り値がSPVMの配列型(汎用オブジェクト配列型を含む)であった場合は、対応するPerlのSPVM::Data::Arrayオブジェクトに変換されます。
      </p>
      <p>
        戻り値がSPVMの配列型以外のオブジェクト型であった場合は、対応するPerlのSPVM::Dataオブジェクトに変換されます。
      </p>
      
      <h2 id="exchange-api-utility">ユーティリティ</h2>
      <ul class="toc">
        <li><a href="#exchange-api-utility-exception">SPVMの例外の取得 - exception</a></li>
        <li><a href="#exchange-api-utility-set_exception">SPVMの例外の設定 - set_exception</a></li>
        <li><a href="#exchange-api-utility-memory_blocks_count">確保されたメモリブロックの数を取得 - memory_blocks_count</a></li>
      </ul>
      
      <p>
        その他のユーティリティです。
      </p>

      <h3 id="exchange-api-utility-exception">SPVMの例外の取得 - exception</h3>
      <p>
        SPVMの例外を取得します。取得される文字列は、undefでなかった場合は、UTF-8とみなしてデコードされた文字列です。
      </p>
<pre>
my $exception = SPVM::exception();
</pre>

      <h3 id="exchange-api-perl-string-to-spvm-byte-array">Perlの文字列をSPVMのbyte[]型に変換 - SPVM::new_byte_array_from_string</h3>
      <p>
        Perlの文字列をSPVMのbyte[]型に変換するには、SPVM::new_byte_array_from_string関数を使います。Perlの文字列は、ここではデコードされた文字列を指します。
      </p>
<pre>
use utf8;
my $spvm_byte_array = SPVM::new_byte_array_from_string("あいうえお");
</pre>
      <p>
        第一引数にPerlの文字列を受け取ります。Perlの文字列は、ここではデコードされた文字列を指します。
      </p>
      <p>
        長さは、UTF-8として、バイト列を数えた場合の長さになります。
      </p>
      <p>
        戻り値は、SPVMの「byte[]」型を表現した「SPVM::Data::Array」オブジェクトです。
      </p>
      <p>
        第一引数が未定義値だった場合は、未定義値が返ります。
      </p>

      <h3 id="exchange-api-perl-string-to-spvm-string">Perlの文字列をSPVMのstring型に変換 - SPVM::new_string</h3>
      <p>
        Perlの文字列をSPVMのstring型に変換するには、SPVM::new_string関数を使います。Perlの文字列は、ここではデコードされた文字列を指します。
      </p>
<pre>
use utf8;
my $spvm_string = SPVM::new_string("あいうえお");
</pre>
      <p>
        第一引数にPerlの文字列を受け取ります。
      </p>
      <p>
        長さは、UTF-8として、バイト列を数えた場合の長さになります。
      </p>
      <p>
        戻り値は、SPVMの「byte[]」型を表現した「SPVM::Data::Array」オブジェクトです。SPVMのstring型は実行時にはbyte[]型として扱われます。
      </p>
      <p>
        第一引数が未定義値だった場合は、未定義値が返ります。
      </p>
      <p>
        この関数は実際には、<a href="#exchange-api-perl-string-to-spvm-byte-array">SPVM::new_byte_array_from_string</a>のエイリアスです。
      </p>

      <h3 id="exchange-api-utility-set_exception">SPVMの例外の設定 - set_exception</h3>
      <p>
        SPVMの例外を設定します。引数は、デコードされた文字列かundefを指定します。
      </p>
<pre>
SPVM::set_exception("あいう");
SPVM::set_exception(undef);
</pre>

      <h3 id="exchange-api-utility-memory_blocks_count">確保されたメモリブロックの数を取得 - memory_blocks_count</h3>
      <p>
        memory_blocks_count関数を使うと、確保されたメモリブロックの数を取得できます。
      </p>
<pre>
my $count = SPVM::get_memory_blocks_count();
</pre>
      <p>
        SPVMランタイムは、オブジェクトを生成するとき、ウィークリファレンスを新しく作成するときに、ヒープからメモリを確保します。一回のメモリ取得の操作によって確保されたメモリをメモリブロックと呼びます。
      </p>
      <p>
        SPVMは、リファレンスカウント式のGCを持っており、通常は、メモリの確保と解放については、意識する必要がありませんが、ネイティブでサブルーチンを記述するときは、メモリリークが起こっていないことを試験で確認したいという場合があるでしょう。
      </p>
<pre>
# 最初のメモリブロックカウント
my $start_memory_blocks_count = SPVM::get_memory_blocks_count();

# 処理
# ...

# 最後のメモリブロックカウント
my $end_memory_blocks_count = SPVM::get_memory_blocks_count();

unless ($end_memory_blocks_count == $start_memory_blocks_count) {
  die "Memroy leak";
}
</pre>

      <h2 id="exchange-api-rule-perl-scalar-to-spvm-numeric">Perlのスカラ値をSPVMの数値型に変換する規則</h2>

      <p>
        Perlのスカラ値をSPVMの数値型に変換する規則は以下で定義されます。
      </p>
      <p>
        変換規則は、C言語で記述されます。SvIVとSvNVは、perlapiで定義された関数です。int8_t, int16_t, int32_t, int64_t, float, doubleは、C99で定義されている型です。
      </p>

      <p>
        <b>Perlのスカラ値をSPVMのbyte型に変換</b>
      </p>
      
<pre>
(int8_t)SvIV(perl_value)
</pre>

      <p>
        <b>Perlのスカラ値をSPVMのshort型に変換</b>
      </p>
<pre>
(int16_t)SvIV(perl_value)
</pre>

      <p>
        <b>Perlのスカラ値をSPVMのint型に変換</b>
      </p>
<pre>
(int32_t)SvIV(perl_value)
</pre>

      <p>
        <b>Perlのスカラ値をSPVMのlong型に変換</b>
      </p>
<pre>
(int64_t)SvIV(perl_value)
</pre>

      <p>
        <b>Perlのスカラ値をSPVMのfloat型に変換</b>
      </p>
<pre>
(float)SvNV(perl_value)
</pre>

      <p>
        <b>Perlのスカラ値をSPVMのdouble型に変換</b>
      </p>
<pre>
(double)SvNV(perl_value)
</pre>

      <h2 id="exchange-api-rule-spvm-numeric-to-perl-scalar">SPVMの数値型をPerlのスカラ値に変換する規則</h2>

      <p>
        Perlのスカラ値をSPVMの数値型に変換する規則は以下で定義されます。
      </p>
      <p>
        変換規則は、C言語で記述されます。newSVivとnewSVnvは、perlapiで定義された関数です。int8_t, int16_t, int32_t, int64_t, float, doubleは、C99で定義されている型です。      
      </p>
      <p>
        SPVMの値は、コードのサンプルでは、不定になっていますが、値が入っているものと考えて下さい。
      <p>

      <p>
        <b>Perlのスカラ値をSPVMのbyte型に変換</b>
      </p>
      
<pre>
int8_t spvm_value;
newSViv(spvm_value)
</pre>

      <p>
        <b>Perlのスカラ値をSPVMのshort型に変換</b>
      </p>
<pre>
int16_t spvm_value;
newSViv(spvm_value)
</pre>

      <p>
        <b>Perlのスカラ値をSPVMのint型に変換</b>
      </p>
<pre>
int32_t spvm_value;
newSViv(spvm_value)
</pre>

      <p>
        <b>Perlのスカラ値をSPVMのlong型に変換</b>
      </p>
<pre>
int64_t spvm_value;
newSViv(spvm_value)
</pre>

      <p>
        <b>Perlのスカラ値をSPVMのfloat型に変換</b>
      </p>
<pre>
float spvm_value;
newSVnv(spvm_value)
</pre>

      <p>
        <b>Perlのスカラ値をSPVMのdouble型に変換</b>
      </p>
<pre>
double spvm_value;
newSVnv(spvm_value)
</pre>
    </div>
